<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>alert</title>
    <style>
        .box {
            position: fixed;
            width: 100%;
            top: 16px;
            left: 0;
            text-align: center;
            pointer-events: none;
            background-color: #fff;
            border: grey 3px solid;
            box-sizing: border-box;
        }
        .box-content {
            width: 200px;
            margin: 10px auto;
            font-size: 14px;
            padding: 8px 16px;
            background: #fff;
            border-radius: 3px;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    
    <div id="app">
        <button @click="vbs">{{ name }}</button>
        <hr/>
        <button @click="iptFocus">è¾“å…¥æ¡†è·å–ç„¦ç‚¹</button>
        <input v-model="myInfo.age" v-if="iptFlag" id="ipt" ref="ipt" type="text">
        <button @click="myInfo.age++">add</button>
        <button @click="deleteKey">deleteKey</button>
        <p>{{ myInfo.name }}ï¼š{{ myInfo.age }}</p>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <hr/>
        <p>{{ filterVal | my-filter | omit }}</p>
        <input v-model="$data._a" type="text">
        <span>{{ $data._a }}</span>
        <br/>
        <br/>
        <hr/>
    </div>

    <div id="app2"></div>
    <div id="app3"></div>
    
    
    <script src="../vue.js"></script>
    <script>
        // æ„é€ å™¨å†…å®¹
        const extendComponent = Vue.extend({
            props: {
                title: '',
                require: true,
                title: {
                    type: String,
                    default: ''
                },
                message: {
                    type: String,
                    default: ''
                },
                duration: {
                    type: Number,
                    default: 2000
                },
            },
            template: `
                <div class="box" v-if="isShow">
                    <h3>{{title}}</h3>
                    <p class="box-content">{{message}}</p>
                </div>
            `,
            data(){
                return {
                    isShow: false
                }
            },
            methods: {
                show(){
                    this.isShow = true;
                    setTimeout(this.hide, this.duration);
                },
                hide(){
                    this.isShow = false;
                    this.remove();
                }
            }
        })

        let instance;
        const MyAlert = (options)=>{
            // åˆ›å»ºå®ä¾‹ å¹¶æŒ‚è½½
            instance = new extendComponent({
                propsData: { ...options }
            }).$mount();

            // å¼¹çª—ç»“æŸæ–¹æ³•
            instance.remove = ()=>{
                // ç§»é™¤å…ƒç´ 
                document.body.removeChild(instance.$el);
                // æ‰‹åŠ¨é”€æ¯å®ä¾‹
                instance.$destroy()
            }
            
            // æŠŠç»„ä»¶å†…å®¹æ’å…¥åˆ°DOMä¸­
            document.body.appendChild(instance.$el);

            return instance;
        }

        // æŠŠæ–¹æ³•æŒ‚è½½åˆ°Vueå®ä¾‹ä¸Š
        Vue.prototype.$alert = (opt)=> {
            const comp = MyAlert(opt);
            comp.show();
            return comp;
        }

        /* filter */
        Vue.filter('my-filter', (val)=>{
            if(!val) return '';
            return val.toString().toUpperCase();
        })
        Vue.filter('omit', (val)=>{
            if(!val) return '';
            return val + '...';
        })
        const omitFilter = Vue.filter('omit');
        console.log(omitFilter);
        
        /* directive */
        Vue.directive('loadmore', (el, binding)=>{

        })
        /* components */
        Vue.component('my-component', {
            model: {
                event:''
            },
            // props: ['name','obj'],
            props: {
                val: {
                    type: Number,
                    default: 1,
                    require: true
                },
                age: Number
            }
        })
        /* extend */
        const Comp = Vue.extend({
            props: ['name']
        })
        const vm2 = new Comp({
            propsData: {
                name: 'å¼ ä¸‰'
            }
        })

        console.log(Vue.version);

        const vm = new Vue({
            el: '#app',
            data: {
                foo: 123,
                name: 'å¼ ä¸‰',
                iptFlag: false,
                myInfo: {
                    name: 'ç‹äº”',
                },
                filterVal: 'hello word!',
                _a: 'å˜¿å˜¿å˜¿',
                $b: 'ğŸ˜ƒ',
                a: 1,
                arr1: [
                    [123],
                    [['qwe'],['zxc']]
                ]
            },
            computed: {
                aPlus: {
                    get(){
                        return this.a + 10;
                    },
                    set(v){
                        console.log(v-1);
                        this.a = v - 1;
                    }
                }
            },
            watch: {
                name: {
                    handler: 'someMethod',
                    immediate: true
                },
                arr1: [
                    'handle1',
                    function handler2(nl,ol){
                        console.log(222222222,nl,ol);
                        function handle3(nl,ol){
                            console.log(3333333,'æ•°ç»„ç¬¬ä¸€ä¸ª');
                        }
                    }
                ]
            },
            objInfo: 'foo',
            mounted(){
                /* åœ¨å“åº”å¼å¯¹è±¡ä¸Šæ–°å¢å“åº”å¼çš„å€¼ */
                // this.myInfo.age = 18;
                this.$set(this.myInfo, 'age', 18)
                console.log(this.$data.filterVal);
                console.log(this.$data._a);
                console.log(this.$data.$b);
                console.log('ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜');
                console.log(this.aPlus);
                console.log(this.aPlus = 5);
                console.log('ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬ğŸ›¬');
                console.log(this.$options.methods);
            },
            methods: {
                vbs(){
                    this.$alert({
                        title: 'æ ‡é¢˜',
                        message: 'æ–‡æ¡ˆ......'
                    })
                },
                iptFocus(){
                    this.iptFlag = true;
                    /* åœ¨è¯•å›¾æ›´æ–°åæ“ä½œæ›´æ–°å¤Ÿçš„dom */
                    // Vue.nextTick(()=>{
                    //     document.getElementById('ipt').focus();
                    // })
                    // this.$nextTick(()=>{
                    //     document.getElementById('ipt').focus();
                    // })
                    setTimeout(()=>{
                        // document.getElementById('ipt').focus();
                        this.$refs['ipt'].focus();
                    }, 0)
                },
                deleteKey(){
                    // delete this.myInfo.age;
                    /* èƒ½ç¡®ä¿åˆ é™¤å“åº”å¼æ•°æ®çš„keyåæ›´æ–°è§†å›¾ */
                    // this.$delete(this.myInfo, 'age');

                    this._a = 'å•¦å•¦å•¦',
                    console.log(this._a);
                },
                someMethod(vl, ol){
                    console.log(vl, ol);
                },
                handle1(nl,ol){
                    console.log('æ•°ç»„ç¬¬ä¸€ä¸ª');
                },
                
            }
        })
    </script>

</body>
</html>